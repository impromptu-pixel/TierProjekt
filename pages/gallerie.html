<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/TierProjekt/">
    <title>Fuchs-Galerie</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.png">
</head>

<body>
    <header class="header">
        <nav class="navigation">
            <div class="logo">
                <h1>ü¶ä F√ºchse</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Startseite</a></li>
                <li><a href="pages/fuchsarten.html">Arten</a></li>
                <li><a href="pages/gallerie.html">Gallerie</a></li>
                <li><a href="kontakt/impressum.html">Impressum</a></li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <section id="gallery" class="content-section">
            <div class="container">
                <h2>Fuchs-Galerie</h2>
                <p>Die sch√∂nsten Fuchsbilder von Reddit</p>

                <div class="loading" id="loading">
                    <p>Lade Bilder...</p>
                </div>

                <div class="gallery-grid" id="galleryGrid">
                    <!-- Bilder werden hier dynamisch geladen -->
                </div>

                <div class="error-message" id="errorMessage" style="display: none;">
                    <p>Fehler beim Laden der Bilder. Bitte versuchen Sie es sp√§ter erneut.</p>
                </div>
            </div>
        </section>

        <section id="zoo-visit" class="content-section alt-bg">
            <div class="container">
                <h2>Mehr als nur Bilder sehen? Besuche den Zoo!</h2>

                <div class="map-container">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2700.6234567890123!2d8.574681!3d47.385085!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x479aa0e22c7b5e3b%3A0x5c1b3f8f3f8f3f8f!2sZoo%20Z%C3%BCrich!5e0!3m2!1sde!2sch!4v1640995200000!5m2!1sde!2sch&maptype=roadmap&zoom=15"
                        width="100%" height="350" style="border:0;" allowfullscreen="" loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>

                <div class="zoo-info">
                    <h3>Zoo Z√ºrich</h3>
                    <p>
                        <strong>Adresse:</strong> Z√ºrichbergstrasse 221, 8044 Z√ºrich<br>
                        <strong>√ñffnungszeiten:</strong> T√§glich 9:00 - 18:00 Uhr<br>
                        <strong>Website:</strong> <a href="https://www.zoo.ch" target="_blank"
                            rel="noopener">www.zoo.ch</a>
                    </p>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Leon K√∂rber</p>
        </div>
    </footer>

    <script>
        async function fetchFoxImages() {
            const loading = document.getElementById('loading');
            const galleryGrid = document.getElementById('galleryGrid');
            const errorMessage = document.getElementById('errorMessage');

            try {
                const response = await fetch('https://api.reddit.com/r/foxes/hot.json?limit=25');
                const data = await response.json();

                loading.style.display = 'none';

                // Filter for image posts
                const imagePosts = data.data.children.filter(post => {
                    const url = post.data.url;
                    const preview = post.data.preview;

                    // Check for direct image URLs
                    const isDirectImage = url.match(/\.(jpg|jpeg|png|gif|webp)$/i);

                    // Check for Reddit hosted images
                    const isRedditImage = url.includes('i.redd.it') || url.includes('i.imgur.com');

                    // Check if post has preview images
                    const hasPreview = preview && preview.images && preview.images.length > 0;
                    return isDirectImage || isRedditImage || hasPreview;
                }).slice(0, 15); // To set how many images are displayed

                console.log(`Found ${imagePosts.length} image posts out of ${data.data.children.length} total posts`);

                if (imagePosts.length === 0) {
                    errorMessage.style.display = 'block';
                    return;
                }

                imagePosts.forEach(post => {
                    const postData = post.data;
                    const galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';

                    let imageUrl = postData.url;

                    // get preview image if available
                    if (postData.preview && postData.preview.images && postData.preview.images.length > 0) {
                        const preview = postData.preview.images[0];
                        if (preview.source && preview.source.url) {
                            imageUrl = preview.source.url.replace(/&amp;/g, '&');
                        }
                    }

                    galleryItem.innerHTML = `
                        <img src="${imageUrl}" alt="${postData.title}" loading="lazy" onerror="this.parentElement.style.display='none'">
                        <div class="gallery-overlay">
                            <h3>${postData.title}</h3>
                            <p>üëç ${postData.ups} Upvotes</p>
                            <a href="https://reddit.com${postData.permalink}" target="_blank" rel="noopener">
                                Auf Reddit ansehen
                            </a>
                        </div>
                    `;

                    galleryGrid.appendChild(galleryItem);
                });

            } catch (error) {
                console.error('Error fetching images:', error);
                loading.style.display = 'none';
                errorMessage.style.display = 'block';
            }
        }

        document.addEventListener('DOMContentLoaded', fetchFoxImages);
    </script>
</body>

</html>